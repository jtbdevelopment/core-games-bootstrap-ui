!function(e){e.module("coreGamesBootstrapUi.config",[]).value("coreGamesBootstrapUi.config",{debug:!0}),e.module("coreGamesBootstrapUi.templates",[]),e.module("coreGamesBootstrapUi.controllers",[]),e.module("coreGamesBootstrapUi.directives",[]),e.module("coreGamesBootstrapUi.filters",[]),e.module("coreGamesBootstrapUi.services",[]),e.module("coreGamesBootstrapUi",["coreGamesBootstrapUi.config","coreGamesBootstrapUi.directives","coreGamesBootstrapUi.filters","coreGamesBootstrapUi.services","coreGamesBootstrapUi.templates","coreGamesBootstrapUi.controllers","ngResource","ngCookies","ngSanitize","ui.bootstrap"])}(angular),angular.module("coreGamesBootstrapUi.controllers").controller("CoreBootstrapInviteCtrl",["$uibModalInstance","invitableFriends","message","jtbFacebook",function(e,t,a,n){var o=this;o.invitableFriends=t,o.chosenFriends=[],o.message=a,o.invite=function(){var t=[];angular.forEach(o.chosenFriends,function(e){t.push(e.id)}),n.inviteFriends(t,a),e.close()},o.cancel=function(){e.dismiss()}}]),angular.module("coreGamesBootstrapUi.controllers").controller("CoreBootstrapSignedInCtrl",["$location","$rootScope","$cacheFactory",function(e,t,a){function n(){a.get("$http").removeAll()}function o(){console.log("Logged in"),n(),t.$broadcast("login"),e.path("/main")}o()}]),angular.module("coreGamesBootstrapUi.controllers").controller("CoreBootstrapSignInCtrl",["$window","$cookies","jtbFacebook",function(e,t,a){function n(){s.showFacebook=!0,s.showManual=e.location.href.indexOf("localhost")>-1||e.location.href.indexOf("-dev")>-1,s.message=""}function o(){s.showFacebook=!1,s.showManual=!1,s.message="Logging in via Facebook",e.location="/auth/facebook"}var s=this;s.message="Initializing...",s.showFacebook=!1,s.showManual=!1,s.csrf=t["XSRF-TOKEN"],s.fbLogin=function(){a.initiateFBLogin().then(function(e){e.auto?o():n()},function(){n()})},a.canAutoSignIn().then(function(e){e.auto?o():n()},function(){n()})}]),angular.module("coreGamesBootstrapUi.services").factory("jtbBootstrapAds",["$q","jtbBootstrapBackdropManager",function(e,t){var a=12e4,n=a,o=new Date(0);return{setFrequency:function(e){n=e},showAdPopup:function(){var a=e.defer();if(new Date-o>=n)try{t.addBackdrop(),invokeApplixirVideoUnitExtended(!1,"middle",function(){t.removeBackdrop(),a.resolve(),o=new Date})}catch(s){t.removeBackdrop(),console.log(JSON.stringify(s)),a.resolve()}else a.resolve();return a.promise}}}]),angular.module("coreGamesBootstrapUi.services").factory("jtbBootstrapBackdropManager",["$animate","$document","$compile","$rootScope",function(e,t,a,n){function o(){if(!angular.isDefined(i)){var n=t.find("body").eq(0);i=angular.element('<div id="jtb-backdrop" uib-modal-backdrop="modal-backdrop"></div>'),i.attr({"class":"modal-backdrop","ng-style":"{'z-index': 1040 + (index && 1 || 0) + index*10}","uib-modal-animation-class":"fade","modal-in-class":"in"}),i.attr("modal-animation","true"),n.addClass(c),a(i)(l),e.enter(i,n)}}function s(){if(!angular.isUndefined(i)){var a=t.find("body").eq(0);e.leave(i).then(function(){a.removeClass(c),i=void 0})}}var i,r=0,c="modal-open",l=n.$new(!0);return l.index=1,{addBackdrop:function(){r+=1,1===r&&o()},removeBackdrop:function(){r-=1,0===r&&s()}}}]),angular.module("coreGamesBootstrapUi.services").run(["$rootScope","$location","$uibModal",function(e,t,a){function n(e){var a=this;a.closeError=function(){e.close(),t.path("/signin")}}function o(){a.open(i)}var s='<div class="general-error-dialog" role="dialog"><div class="modal-header"><h4 class="modal-title">Sorry!</h4></div><div class="modal-body"><span class="error-message">Something has gone wrong, going to try to re-login and reset.</span></div><div class="modal-footer"><button class="btn btn-default btn-info btn-default-focus close-button" ng-click="errorDialog.closeError()">OK</button></div></div>',i={controller:["$uibModalInstance",n],controllerAs:"errorDialog",template:s};e.$on("InvalidSession",function(){o()}),e.$on("GeneralError",function(){o()})}]),angular.module("coreGamesBootstrapUi.services").factory("jtbBootstrapGameActions",["$http","$q","$location","$uibModal","jtbGameCache","jtbPlayerService","jtbBootstrapAds","jtbBootstrapBackdropManager",function(e,t,a,n,o,s,i,r){function c(e,t){var a=this;a.errorMessage=t,a.closeError=function(){e.close()}}function l(e,t){var a=this;a.confirmMessage=t,a.takeAction=function(){e.close()},a.cancelAction=function(){e.dismiss()}}function d(e){var t={controller:["$uibModalInstance","message",c],controllerAs:"errorDialog",resolve:{message:function(){return e}}};angular.isDefined(h)?t.templateUrl=h:t.template=y,n.open(t)}function u(e){return s.currentPlayerBaseURL()+"/game/"+e.id+"/"}function m(){r.addBackdrop()}function v(){r.removeBackdrop()}function f(e){var a=t.defer();return m(),e.then(function(e){var t=e.data;v(),o.putUpdatedGame(t),a.resolve(t)},function(e){console.error(e.data+"/"+e.status),v(),k(e.data),a.reject()}),a.promise}function p(e,a){var o=t.defer(),s={controller:["$uibModalInstance","message",l],controllerAs:"confirmDialog",resolve:{message:function(){return e}}};return angular.isDefined(w)?s.templateUrl=w:s.template=B,n.open(s).result.then(function(){f(a()).then(function(e){o.resolve(e)},function(){o.reject()})},function(){o.reject()}),o.promise}function g(t,a){return e.put(u(t)+a)}function b(e){return angular.isUndefined(e)&&(e=G),e()}var h,w,y='<div class="game-error-dialog" role="dialog"><div class="modal-header"><h4 class="modal-title">Sorry!</h4></div><div class="modal-body"><span class="error-message">{{errorDialog.errorMessage}}</span></div><div class="modal-footer"><button class="btn btn-default btn-info btn-default-focus close-button" ng-click="errorDialog.closeError()">OK</button></div></div>',B='<div class="game-confirm-dialog"><div class="modal-header"><h4 class="modal-title">{{confirmDialog.confirmMessage}}</h4></div><div class="modal-body"><span class="confirm-message">Are you sure?</span></div><div class="modal-footer"><button class="btn btn-default btn-danger action-button" ng-click="confirmDialog.takeAction()">Yes</button><button class="btn btn-default btn-default btn-default-focus cancel-button" ng-click="confirmDialog.cancelAction()">No</button></div></div>',k=d,G=i.showAdPopup,x={getErrorHandler:function(){return k},setErrorHandler:function(e){k=e},setConfirmDialogHTMLTemplate:function(e){w=e},setErrorDialogHTMLTemplate:function(e){h=e},getGameURL:function(e){return u(e)},wrapActionOnGame:function(e){return f(e)},wrapConfirmedActionOnGame:function(e,t){return p(e,t)},"new":function(t,n){b(n).then(function(){x.wrapActionOnGame(e.post(s.currentPlayerBaseURL()+"/new",t)).then(function(e){a.path("/game/"+e.gamePhase.toLowerCase()+"/"+e.id)})})},accept:function(e,t){b(t).then(function(){x.wrapActionOnGame(g(e,"accept"))})},reject:function(e){x.wrapConfirmedActionOnGame("Reject this game!",function(){return g(e,"reject")})},declineRematch:function(e){x.wrapConfirmedActionOnGame("Decline further rematches.",function(){return g(e,"endRematch")})},rematch:function(e,t){b(t).then(function(){x.wrapActionOnGame(g(e,"rematch")).then(function(e){a.path("/game/"+e.gamePhase.toLowerCase()+"/"+e.id)})})},quit:function(e){x.wrapConfirmedActionOnGame("Quit this game!",function(){return g(e,"quit")})}};return x}]),angular.module("coreGamesBootstrapUi.services").factory("jtbBootstrapVersionNotesService",["$uibModal","jtbPlayerService",function(e,t){function a(e,t,a){var n=this;n.currentVersion=t,n.releaseNotes=a,n.close=function(){e.close()}}return{displayVersionNotesIfAppropriate:function(n,o,s){if(angular.isUndefined(s)&&(s="views/core-bs/version-notes/version-notes.html"),t.currentPlayer().lastVersionNotes<n){var i={controller:["$uibModalInstance","currentVersion","releaseNotes",a],controllerAs:"versionDialog",templateUrl:s,resolve:{currentVersion:function(){return n},releaseNotes:function(){return o}}};e.open(i),t.updateLastVersionNotes(n)}}}}]),angular.module("coreGamesBootstrapUi.templates").run(["$templateCache",function(e){e.put("views/core-bs/admin/admin-stats.html",'<div class="admin-stats"><div class="row"><table class="table table-striped table-condensed table-admin-states"> <tr> <th></th> <th class="text-right">Last 24 hours</th> <th class="text-right">Last 7 days</th> <th class="text-right">Last 30 days</th> </tr> <tr class="text-right"> <th class="text-left">Total Games</th> <td colspan="3">{{admin.gameCount}}</td> </tr> <tr class="text-right"> <th class="text-left">Games Created</th> <td>{{admin.gamesLast24hours}}</td> <td>{{admin.gamesLast7days}}</td> <td>{{admin.gamesLast30days}}</td> </tr> <tr class="text-right"> <th class="text-left">Total Players</th> <td colspan="3">{{admin.playerCount}}</td> </tr> <tr class="text-right"> <th class="text-left">Players Created</th> <td>{{admin.playersCreated24hours}}</td> <td>{{admin.playersCreated7days}}</td> <td>{{admin.playersCreated30days}}</td> </tr> <tr class="text-right"> <th class="text-left">Players Logged In</th> <td>{{admin.playersLastLogin24hours}}</td> <td>{{admin.playersLastLogin7days}}</td> <td>{{admin.playersLastLogin30days}}</td> </tr> </table> </div> </div>'),e.put("views/core-bs/admin/admin-switch-player.html",'<div class="admin-user"><div class="row"><div class="col-xs-4"><button class="btn btn-default btn-default-focus btn-success btn-stop-simulating"ng-disabled="!admin.revertEnabled" ng-click="admin.revertToNormal()">Stop</button></div><div class="col-xs-8">{{admin.revertText}}</div></div><div class="row"><div class="col-xs-4"><button class="btn btn-default btn-default-focus btn-primary btn-get-users"ng-click="admin.refreshData()">Get Users</button></div><div class="col-xs-8"><input class="form-control" type="text" ng-model="admin.searchText"placeholder="And Name contains.."></div></div><div class="row"><div class="col-xs-12"><table class="table table-striped table-condensed table-admin-users"><tr><th>Display Name</th><th>ID</th><th>Switch</th></tr><tr ng-repeat="player in admin.players"><td>{{player.displayName}}</td><td>{{player.id}}</td><td><button class="btn btn-danger btn-danger btn-change-user"ng-click="admin.switchToPlayer(player.id)">Switch to this user..</button></td></tr></table></div></div><div class="row"><div class="col-xs-12"><ul uib-pagination num-pages="admin.numberOfPages" items-per-page="admin.pageSize"direction-links="false" total-items="admin.totalItems" ng-model="admin.currentPage"ng-change="admin.changePage()"></ul></div></div></div>'),e.put("views/core-bs/admin/admin.html",'<div class="admin-screen"><div class="row"><div class="col-xs-8 col-xs-offset-2"><uib-tabset type="tabs" justified="true"><uib-tab heading="Stats"><div ng-include="\'views/core-bs/admin/admin-stats.html\'"></div></uib-tab><uib-tab heading="Switch player"><div ng-include="\'views/core-bs/admin/admin-switch-player.html\'"></div></uib-tab></uib-tabset></div></div></div>')}]),angular.module("coreGamesBootstrapUi.templates").run(["$templateCache",function(e){e.put("views/core-bs/friends/invite-friends.html",'<div class="invite-dialog"><div class="modal-header"><h3 class="modal-title">Invite Friends to Play</h3></div><div class="modal-body"><ui-select multiple ng-model="invite.chosenFriends" theme="bootstrap" reset-search-input="true"><ui-select-match placeholder="Select friends...">{{$item.name}}</ui-select-match><ui-select-choices repeat="friend in invite.invitableFriends | propsFilter: {name: $select.search}"><div ng-bind-html="friend.name | highlight: $select.search"></div></ui-select-choices></ui-select></div><div class="modal-footer"><button class="btn btn-primary" ng-click="invite.invite()">Invite</button><button class="btn btn-warning" ng-click="invite.cancel()">Cancel</button></div></div>')}]),angular.module("coreGamesBootstrapUi.templates").run(["$templateCache",function(e){e.put("views/core-bs/sign-in/sign-in.html",'<div class="sign-in ng-cloak"><div class="container-fluid"><div class="row text-center"><div class="center"><p>{{signIn.message}}</p></div></div></div><div class="container-fluid" ng-show="signIn.showFacebook"><div class="row text-center"><div class="center"><a href="#" ng-click="signIn.fbLogin()"><img ng-src="/images/sign-in-with-facebook.png"/></a></div></div></div><div class="container-fluid" ng-show="signIn.showManual"><div class="row text-center"><p>Don\'t want to login with Facebook?</p><form id="signin" action="/signin/authenticate" method="post" class="form-group"><input id="_csrf" name="_csrf" type="hidden" value="{{csrf}}"/><div class="form-group"><label for="username">Username</label><input id="username" name="username" type="text" size="25"/></div><div class="form-group"><label for="password">Password</label><input id="password" name="password" type="password" size="25"/></div><div class="form-group"><div class="checkbox"><label><input type="checkbox" id="remember-me" name="remember-me"> Remember me</label></div></div><div class="form-group"><button type="submit" class="btn btn-default">Sign in</button></div></form></div></div></div>'),e.put("views/core-bs/sign-in/signed-in.html",'<div class="row signed-in"><div class="row text-center"><div class="center"><p>Login successful...</p></div></div></div>')}]),angular.module("coreGamesBootstrapUi.templates").run(["$templateCache",function(e){e.put("views/core-bs/version-notes/version-notes.html",'<div class="version-dialog"><div class="modal-header"><h3 class="modal-title">Welcome to version {{versionDialog.currentVersion}}</h3></div><div class="modal-body"><span class="version-message">{{versionDialog.releaseNotes}}</span></div><div class="modal-footer"><button class="btn btn-default btn-info btn-default-focus close-button" ng-click="versionDialog.close()">OK</button></div></div>')}]);